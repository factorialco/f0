import {
  Canvas,
  Meta,
  Controls,
  Unstyled,
  Story,
} from "@storybook/addon-docs/blocks"
import LinkTo from "@storybook/addon-links/react"
import * as ListStories from "./list.stories"

<Meta title="Data Collection/Visualizations/List" />

# List Visualization

## Introduction

The List visualization is a visualization that displays the data in a list
format. It's an hybrid between the card and the table visualization, as there
are fixed fiedlds (title, avatar, description) and dynamic fields (properties).

## Examples

<Canvas of={ListStories.BasicListVisualization} />

## Setting Up List Visualization

To enable the List visualization in your data collection component, provide the
`type: "list"` in the `visualizations` prop:

```tsx
<OneDataCollection
  source={dataSource}
  visualizations={[
    {
      type: "list",
      options: {
        itemDefinition: (item) => ({
          title: item.name,
          description: [item.email, item.role],
          avatar: {
            type: "person",
            firstName: item.name.split(" ")[0],
            lastName: item.name.split(" ")[1],
          },
        }),
        fields: [
          { label: "Name", render: (item) => item.name, sorting: "name" },
          { label: "Email", render: (item) => item.email, sorting: "email" },
          { label: "Role", render: (item) => item.role },
          { label: "Department", render: (item) => item.department },
          { label: "Status", render: (item) => item.status },
          { label: "Manager", render: (item) => item.manager },
        ],
      },
    },
  ]}
/>
```

## List Properties

```ts
type ListVisualizationOptions<T> = {
  /**
   * The properties to display in the list.
   */
  fields: ListPropertyDefinition<T>[]

  /**
   * The definition of the item to display in the list.
   */
  itemDefinition: (item: T) => {
    title: string
    description?: string[]
    avatar?: AvatarVariant & {
      badge?: AvatarBadge
    }
  }
}
```

## Card Property Definition

```ts
type CardPropertyDefinition<T> = {
  /**
   * The label to display for the property.
   */
  label: string

  /**
   * The function to render the property.
   */
  render: (item: T) => DisplayValueDefinition
  /**
   * The icon to display for the property.
   */
  icon?: IconType
  /**
   * Allows you to hide the property for a given item.
   */
  hide?: (item: T) => boolean
}
```

## Complete Example

```tsx
<OneDataCollection
  source={dataSource}
  visualizations={[
    {
      type: "list",
    options: {
      itemDefinition: (item) => ({
        title: item.name,
        description: [item.email, item.role],
        avatar: {
          type: "person",
          firstName: item.name.split(" ")[0],
          lastName: item.name.split(" ")[1],
          badge: {
            type: "module",
            module: "inbox",
            tooltip: "Inbox",
          },
        },
      }),
      fields: [
        {
          label: "Email",
          render: (item) => item.email,
          sorting: "email",
        },
        {
          label: "Role",
          render: (item) => item.role,
          sorting: "role",
        },
        {
          label: "Email 2",
          render: (item) => item.email,
          sorting: "email",
        },
        {
          label: "Role 2",
          render: (item) => item.role,
          sorting: "role",
        },
        {
          label: "Manager",
          render: (item) => ({
            type: "person",
            value: {
              firstName: item.manager.split(" ")[0],
              lastName: item.manager.split(" ")[1],
            },
          }),
          hide: (item) => item.name.startsWith("D"),
        },
        {
          label: "Department",
          render: (item) => ({
            type: "dotTag",
            value: {
              color: "yellow",
              label: item.department,
            },
          }),
        },
      ],
    },
```

## Item actions

The list visualization supports item actions. To enable item actions, provide
the `itemActions` prop to the `useDataCollectionSource` hook.

```tsx
<OneDataCollection
  source={{
    itemActions: (item) => [
      { label: "Action 1", onClick: () => console.log("Action 1"), type: "primary" },
      { label: "Action 2", onClick: () => console.log("Action 2"), type: "secondary" },
      { label: "Action 3", onClick: () => console.log("Action 3"), type: "other" },
      ...
    ],
  }}
/>
```

The action type will make the action to be displayed in the list dropdown menu
(other and secondary type), or in in a button (primary type).

## Examples

### List with grouping

<Canvas of={ListStories.ListVisualizationWithGrouping} />

### List with item actions and sorting

<Canvas
  of={ListStories.ListVisualizationWithGroupingAndAllGroupsOpenByDefault}
/>

### List with item actions and filtering

<Canvas
  of={ListStories.ListVisualizationWithGroupingAndAllGroupsOpenByDefault}
/>
