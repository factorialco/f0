import {
  Canvas,
  Meta,
  Controls,
  Unstyled,
  Story,
} from "@storybook/addon-docs/blocks"
import { DoDonts } from "@/lib/storybook-utils/do-donts"

import * as ActionsStories from "./collection-actions.stories"
import * as ItemActionsStories from "./item-actions.stories"
import * as IndexStories from "../index.stories"

<Meta title="Data collection/Actions" />

# Data collection / Actions

## Introduction

Data Collection provides a hierarchy of actions for data operations:

- **Primary action**: The main action, visually emphasized, designed for the
  most common operation (such as “adding a new resource”).
- **Secondary action**: Complementary actions with less visual prominence. If
  there are multiple secondary actions, they should be grouped within the "More
  options" (ellipsis) menu, to avoid adding a second button. The goal is to
  minimize the toolbar space as much as possible to allow room for other
  elements and to avoid overwhelming the user.
- **"More options" button**: A dropdown menu containing additional actions,
  optimizing space and maintaining a clean interface.

Data collection allows you to define actions in different levels:

### Collection actions

Are displayed in the top right and allows to perform actions related to the
collection but not to any specific items.

There 2 types of collection actions:

- **Primary actions**: Are displayed in the top right button. (only one per data
  collection). Primary actions are defined in the `primaryActions` property of
  the useDataCollectionSource hook.

```tsx
const dataSource = useDataCollectionSource({
  primaryActions: () => ({
    // The label of the action
    label: "Action 1",
    // The icon of the action
    icon: <Icon />,
    // The onClick handler of the action
    onClick: () => console.log("Action 1"),
  }),
})
```

You can also pass an array of actions and they will be rendered as a
F0ButtonDropdown, with the first action as main action.

````tsx
const dataSource = useDataCollectionSource({
  primaryActions: () => [
    {
      label: "Action 1",
      icon: <Icon />,
      onClick: () => console.log("Action 1"),
    },
    {
      label: "Action 2",
      icon: <Icon />,
      onClick: () => console.log("Action 2"),
    },
    {
      label: "Action 3",
      icon: <Icon />,
      onClick: () => console.log("Action 3"),
    },
  ],
})


- **Secondary actions**: Are an array of actions and by defualt are displayed a
  dropdown. But you can define the number of actions to display as a secondary
  button using the `expanded` property. You can also hide the label of the
  action when it's expanded using the `hideLabelWhenExpanded` property in the
  action definition.

```tsx
const dataSource = useDataCollectionSource({
  secondaryActions: {
    expanded: 1,
    actions: () => [
      {
        label: "Action 1",
        onClick: () => console.log("Action 1"),
        hideLabelWhenExpanded: true,
      },
      {
        label: "Action 2",
        onClick: () => console.log("Action 2"),
      },
      {
        label: "Action 3",
        onClick: () => console.log("Action 3"),
      },
    ],
  },
})
````

Or as array of actions

```tsx
const dataSource = useDataCollectionSource({
  secondaryActions: () => [
    {
      label: "Action 1",
      onClick: () => console.log("Action 1"),
    },
    {
      label: "Action 2",
      onClick: () => console.log("Action 2"),
    },
    {
      label: "Action 3",
      onClick: () => console.log("Action 3"),
    },
  ],
})
```

### Examples

#### Basic example

<Canvas of={ActionsStories.BasicActionsExample} />

#### Multiple primary actions

<Canvas of={ActionsStories.MultiplePrimaryActionsExample} />

#### With expanded actions

<Canvas of={ActionsStories.WithExpandedActionsExample} />

#### Hidden label expanded actions

<Canvas of={ActionsStories.HiddenLabelExpandedActionsExample} />

## Item actions

The items provide a streamlined interaction approach:

- Primary interaction is navigational - clicking a row opens the associated
  resource, side panel or modal.
- Do not support individual cell-level actions

The actions are defined in the `itemActions` prop of the
`useDataCollectionSource` hook via a function that get the item and returns an
array of actions, that allows you to define diffrent actions for each item, or
for specific items.

```tsx
const dataSource = useDataCollectionSource({
  itemActions: (item) => [
    {
      label: "Action 1",
      onClick: () => console.log("Action 1"),
    },
}
```

It can also return undefined to not display any action for the item.

```tsx
const dataSource = useDataCollectionSource({
  itemActions: (item) => {
    if (item.id === "1") {
      return undefined
    }
    return [
      {
        label: "Action 1",
        onClick: () => console.log("Action 1"),
      },
    ]
  },
})
```

### Examples

<Canvas of={ItemActionsStories.BasicActionsExample} />

## ItemUrl

Navigate to the item detail page, is a common pattern in data collections. You
can also the target url for each item using the `itemUrl` property of the
`useDataCollectionSource` hook.

```tsx
const dataSource = useDataCollectionSource({
  itemUrl: (item) => `/users/${item.id}`,
})
```

This property is a funtion that get the item and returns a string with the url
of the item (or undefined to not link the item).

<Canvas of={IndexStories.WithLinkedItems} />
