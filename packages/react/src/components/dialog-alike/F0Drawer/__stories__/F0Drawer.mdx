import { Canvas, Meta, Controls } from "@storybook/addon-docs/blocks"
import * as F0DrawerStories from "./F0Drawer.stories"

<Meta of={F0DrawerStories} />

# F0Drawer

## Introduction

F0Drawer is a component that provides a drawer interface for the application. It is used to display a drawer to the user.

## Anatomy

<Canvas of={F0DrawerStories.Default} />
<Controls of={F0DrawerStories.Default} />

## Props

### Core Props

| Prop                    | Type                | Default   | Description                                        |
| :---------------------- | :------------------ | :-------- | :------------------------------------------------- |
| `isOpen`                | `boolean`           | -         | Whether the drawer is open                         |
| `onClose`               | `() => void`        | -         | Callback when drawer is closed                     |
| `position`              | `"left" \| "right"` | `"right"` | The position of the drawer                         |
| `size`                  | `"md"`              | `"md"`    | The size of the drawer                             |
| `title`                 | `string`            | -         | Title of the drawer                                |
| `description`           | `string`            | -         | Description text below title                       |
| `modal`                 | `boolean`           | `false`   | Whether drawer is modal (only closable by actions) |
| `disableContentPadding` | `boolean`           | `false`   | Disable default padding in content area            |

### Module and Navigation Props

| Prop             | Type                                            | Description                     |
| :--------------- | :---------------------------------------------- | :------------------------------ |
| `module`         | `{ id: ModuleId, label: string, href: string }` | Module configuration for header |
| `otherActions`   | `DropdownItem[]`                                | Additional actions in header    |
| `tabs`           | `TabsProps["tabs"]`                             | Tabs to display in header       |
| `activeTabId`    | `string`                                        | Active tab ID                   |
| `setActiveTabId` | `(id: string) => void`                          | Callback when tab is selected   |

### Actions Props

| Prop              | Type                                 | Description                   |
| :---------------- | :----------------------------------- | :---------------------------- |
| `primaryAction`   | `F0DrawerAction \| F0DrawerAction[]` | Primary action(s) in footer   |
| `secondaryAction` | `F0DrawerAction \| F0DrawerAction[]` | Secondary action(s) in footer |

### F0DrawerAction Type

The `F0DrawerAction` type defines the properties for the buttons in the footer.

```typescript
type F0DrawerAction = {
  value?: string // Optional value identifier (used when primaryAction is array)
  label: string // Button label text
  icon?: IconType // Optional icon component
  onClick: () => void | Promise<void> // Click handler - can return promise
  disabled?: boolean // Whether button is disabled
  loading?: boolean // Whether button shows loading state
  closeOnClick?: boolean // Close drawer after promise resolves
}
```

## Special Behaviors

### Promise-based Actions & closeOnClick

The `onClick` handler of actions has special support for Promises, which interacts with the `closeOnClick` property.

- **Loading State**: If `onClick` returns a Promise, the button automatically enters a loading state and becomes disabled while the promise is pending.
- **Auto-closing**:
  - If `closeOnClick` is `true`, the drawer will automatically close (`onClose` is called) **after** the promise resolves.
  - If `closeOnClick` is `false` or undefined, the drawer remains open after the promise resolves.

This is particularly useful for form submissions or async operations where you want to show feedback (loading) and then close the drawer upon success.

```tsx
primaryAction={{
  label: "Save",
  onClick: async () => {
    await saveData() // Button shows loading spinner during this call
  },
  closeOnClick: true // Drawer closes only after saveData() finishes
}}
```

## Examples

### Position: Left

Drawers can be positioned on the left side of the screen. The default position is `right`.

<Canvas of={F0DrawerStories.LeftPosition} />

### With Module and Tabs

Drawers can include module information and tabs in the header for complex content organization.

<Canvas of={F0DrawerStories.WithModuleAndTabs} />

### With Resource Header

You can embed a `ResourceHeader` component within the drawer content for a consistent header experience.

<Canvas of={F0DrawerStories.WithResourceHeader} />

### Async Action (Promise)

Example of an action that returns a promise, triggering the loading state.

<Canvas of={F0DrawerStories.WithPromisePrimaryAction} />

### Modal

When `modal` is true, the drawer forces the user to interact with it and displays an overlay.

<Canvas of={F0DrawerStories.Modal} />

## Guidelines

- **Use Cases**: Use `F0Drawer` for secondary content, details panels, or complex forms that need more space than a dialog but less context switch than a full page navigation.
- **Position**: Use `right` (default) for most detail views. Use `left` only for navigation menus or specific layout requirements.
- **Size**: Currently, the drawer supports `md` size. Ensure your content fits comfortably.
- **Actions**: Similar to Dialogs, keep primary actions clear and use secondary actions for cancellations.
